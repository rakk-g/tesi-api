\chapter[Modelli]{Modelli matematici}
In questo capitolo discuteremo alcuni modelli proposti in letteratura per descrivere la dinamica della popolazione di una colonia di \emph{Apis Mellifera}.

\paragraph{}
Il primo modello che prendiamo in considerazione \parencite{ratti2017} suddivide la popolazione di operaie in api ``di alveare'' -- che svolgono mansioni di cura e manutenzione all'interno del nido -- e in bottinatrici.
Gli altri compartimenti del modello riguardano la popolazione di \emph{V.~destructor} e le api infette dal virus della paralisi (ABPV), trasmesso dagli acari.

\section{Modello a tre compartimenti di operaie, con \emph{Varroa} e ABPV}
Esaminiamo il modello proposto da \citeauthor{ratti2017} nel \citeyear{ratti2017}, che estende alcune proposte precedenti con lo scopo di studiare gli effetti diretti e indiretti di \emph{Varroa destructor} sulla popolazione di un alveare.

\subsection{Derivazione del modello}
Per ottenere una formulazione del modello, gli autori di \cite{ratti2017} propongono le seguenti assunzioni preliminari:
\begin{enumerate}
    \item La popolazione delle operaie sane (non infette da ABPV) è suddivisa in due comparti: le operaie più giovani che svolgono mansioni all'interno dell'alveare ($x_h$) e le bottinatrici/esploratrici ($x_f$).

    Questa impostazione ricalca lo studio \cite{khoury2011}, in cui si propone un modello a due compartimenti per esaminare gli effetti del tasso di schiusa delle pupe e del tasso di reclutamento da operaie d'alveare a bottinatrici sulla dinamica di una popolazione sana.
    \item La popolazione degli acari è suddivisa in due comparti: le varroe portatrici di ABPV ($m$) e le varroe libere dal virus ($n$).
    \item Le operaie infette con ABPV ($y$) perdono rapidamente l'abilità al volo, le loro capacità di orientamento degradano e muoiono in breve tempo. Per questo motivo le api infette sono considerate ``di alveare'', e non vengono reclutate per bottinare.
\end{enumerate}

I compartimenti del modello sono dunque cinque:
\begin{itemize}
    \item il numero di operaie di nido sane, $x_h$
    \item il numero di operaie bottinatrici sane, $x_f$
    \item il numero di operaie infette, $y$
    \item il numero di varroe portatrici di ABPV, $m$
    \item il numero di varroe senza virus, $n$
\end{itemize}

Abbiamo inoltre
$$\text{Pop. totale api} = x_h + x_f + y,$$
e
$$\text{Pop. totale varroe} = m + n.$$

Proseguiamo con l'esame delle assunzioni del modello:
\begin{enumerate}
    \setcounter{enumi}{3}
    \item Il tasso massimale di riproduzione delle varroe è lo stesso, che siano portatrici di virus o meno.
    Ciò si riflette nelle equazioni \eqref{eq:r17m} e \eqref{eq:r17n}, in cui il primo termine descrive le nuove nascite: esso è proporzionale alla popolazione del compartimento ed il fattore di proporzionalità è lo stesso in entrambe le equazioni. In esso, $r$ è il tasso massimo di riproduzione del parassita \emph{Varroa}, mentre $\alpha$ è la capacità portante dell'ospite \emph{Apis}.
    \item Sappiamo che la covata necessita di cure da parte delle operaie nutrici, quindi il tasso di schiusa è dipendente dal numero di operaie sane nella popolazione, che seguendo \cite{khoury2011} assumiamo pari alla somma $x_h + x_f$.
    \item L'ape regina non subisce gli effetti avversi di ABPV e dell'infestazione da varroe; di conseguenza, il tasso di schiusa non dipende dalla preminenza nell'alveare di varroe o di virus.
    \item La trasmissione di ABPV è esclusivamente orizzontale: ciò significa che l'infezione di una operaia avviene per trasmissione del virus da un'altra operaia infetta.\footnote{La trasmissione \emph{verticale} di un patogeno riguarda invece l'infezione della prole a causa dei genitori già infetti.}

    Le varroe sono un vettore puramente meccanico per il virus: la carica virale non è incentivata né inibita dalle varroe, che per ABPV fungono meramente da ``mezzo di trasporto'' tra le api.
    \item Poiché le pupe infette con ABPV muoiono rapidamente prima della schiusa, tutte le giovani operaie che giungono all'età adulta si assumono libere dal virus. L'effetto limitante sul tasso di schiusa dovuto alla presenza di varroe infette viene incorporato in un fattore di modulazione $h(m)$.
    \item Per studiare l'effetto dei trattamenti acaricidi, introduciamo un ulteriore termine di pozzo $\delta_i$ in ogni equazione. Assumiamo che l'impatto dei trattamenti sia di gran lunga maggiore sulle varroe che sulle api: $\delta_4, \delta_5 > \delta_1, \delta_2, \delta_3$.
    \item In tutti e tre i compartimenti delle api, si assume un tasso di mortalità naturale $d_i$ in aggiunta alla mortalità dovuta alle varroe $\gamma_i$ (a sua volta dipendente sia dal parassitismo che dalla trasmissione del virus). Nelle api indebolite dall'infezione da ABPV entrambi questi tassi sono maggiori rispetto alle operaie sane: $d_3 > d_1, d_2$ e $\gamma_3 > \gamma_1, \gamma_2$.

    Inoltre per le bottinatrici si tiene conto anche della mortalità da disorientamento (fattore $p$), dovuto principalmente al degrado delle facoltà cognitive e di navigazione per effetto dei pesticidi sintetici sulle colture.
\end{enumerate}


\subsubsection{Equazione del modello}
Il modello a compartimenti proposto in \cite{ratti2017} è il seguente:
\begin{align}
    % hive sane
    \diff{x_h}{t} &= \mu g( x_h + x_f ) h(m) - \beta_1 m \frac{x_h}{x_h + x_f + y} - \left( d_1 + \delta_1 \right) x_h \notag \\ % barbatrucco
    \label{eq:r17xh}
        &{\;} - \gamma_1 (m+n) x_h - x_h \cdot R(x_h, x_f) \\ % barbatrucco
    % foragers sane
    \label{eq:r17xf}
    \diff{x_f}{t} &= x_h \cdot R(x_h, x_f) - \beta_1 m \frac{x_f}{x_h + x_f + y}
    - \left( p + d_2 + \delta_2 \right) x_f - \gamma_2 (m+n) x_f \\
    % (hive) infette
    \label{eq:r17y}
    \diff{y}{t} &= \beta_1 m \frac{x_h + x_f}{x_h + x_f + y} - \left( d_3 + \delta_3 \right) y - \gamma_3 (m+n) y \\
    % varroe con ABPV
    \label{eq:r17m}
    \diff{m}{t} &= rm \left( 1 - \frac{m+n}{ \alpha (x_h + x_f + y) } \right) + \beta_2 n \frac{y}{x_h + x_f + y}
    - \beta_3 m \frac{x_h + x_f}{x_h + x_f + y} - \delta_4 m \\
    % varroe senza ABPV
    \label{eq:r17n}
    \diff{n}{t} &= rn \left( 1 - \frac{m+n}{ \alpha (x_h + x_f + y) } \right) - \beta_2 n \frac{y}{x_h + x_f + y}
    + \beta_3 m \frac{x_h + x_f}{x_h + x_f + y} - \delta_5 n
\end{align}

% ELIMINO RIPETIZIONE
% dove
% \begin{itemize}
%     \item $x_h$ è il numero di operaie sane che vivono all'interno dell'alveare (\emph{hive})
%     \item $x_f$ è il numero di operaie bottinatrici (\emph{foragers})
%     \item $y$ è il numero di operaie infette da ABPV
%     \item $m$ è il numero di varroe portatrici di ABPV
%     \item $n$ è il numero di varroe non portatrici di virus.
% \end{itemize}

\paragraph{}
Il termine ``di reclutamento'' $x_h \cdot R(x_h, x_f)$ nelle equazioni \eqref{eq:r17xh} e \eqref{eq:r17xf} rappresenta appunto il passaggio di ruolo delle operaie, da impiegate \emph{all'interno} dell'alveare a \emph{bottinatrici} che escono dall'arnia per esplorare e raccogliere il cibo.

Come nello studio precedente \cite{khoury2011}, il fattore $R$ rappresenta gli effetti \emph{sociali}
della colonia sul tasso di reclutamento, con la seguente formulazione:
\begin{equation}
    \label{eq:reclutam}
    R(x_h, x_f) = \sigma_1 - \sigma_2 \left( \frac{x_f}{x_h + x_f} \right)
\end{equation}
in cui $\sigma_1$ è il tasso massimo di reclutamento delle operaie, quando non ci sono bottinatrici nella colonia.
Il termine $\sigma_2 \left( \frac{x_f}{x_h + x_f} \right)$ descrive l'inibizione sociale del reclutamento, ossia il rallentamento del processo di ``promozione'' all'esterno del nido, proporzionale alla frazione di popolazione impiegata nella bottinatura; quando tale frazione è in surplus, le bottinatrici vengono ``riallocate'' in attività interne all'alveare.

\paragraph{}
Il tasso di nuove nascite è descritto dal primo termine nella equazione \eqref{eq:r17xh}, in cui troviamo il parametro $\mu$ che è determinato principalmente dalla regina e dalla stagione, e rappresenta il tasso massimo di schiusa (in unità di numero di api al giorno).

La funzione $g$ descrive il bisogno di un numero minimo di operaie sane nella colonia per allevare la covata; se questo numero scende sotto una certa soglia -- che può presentare variazioni stagionali -- la covata non produce più api adulte.
La $g$ rappresenta la risposta funzionale dell'allevamento della covata; nelle parole degli autori:
\begin{displayquote}[\cite{ratti2017}]
``We think of $g(x_h + x_f)$ as a switch function.''
\end{displayquote}

Abbiamo dunque $g(0)=0$, $\diff{g}{x_h} \geq 0$ e $\diff{g}{x_f} \geq 0$. Inoltre $\lim_{x_h+x_f \to \infty} g(x_h+x_f)=1$, e dunque un'utile formulazione per $g$ è data dalla sigmoide di Hill (figura~\ref{img:hillSigmoid}):
\begin{equation}
    g(x_h + x_f) = \frac{ (x_h+x_f)^i }{ K^i + (x_h+x_f)^i }
    \label{eq:hillSigmoid}
\end{equation}

\begin{figure}
    \centering
    \includegraphics[keepaspectratio,width=0.86\textwidth]{img/hillSigmoid}

    \caption[Sigmoidi di Hill.]{Sigmoide di Hill per diversi valori dell'esponente $i$.
        \\ Il parametro $K$ rappresenta la retroimmagine del semimassimo.}
    \label{img:hillSigmoid}
\end{figure}

dove $K$ è la dimensione della popolazione di operaie nell'alveare corrispondente al tasso di schiusa semimassimo, e l'esponente $i>1$ si assume intero per semplicità di analisi.

\paragraph{}
Sempre nel termine delle nascite di api adulte, un altro fattore modulante tiene conto degli effetti deleteri per la covata dovuti alla presenza degli acari portanti ABPV nell'alveare: le larve e le pupe infette dal virus muoiono rapidamente prima di raggiungere lo stadio di adulte, quindi la funzione $h(m)$ nell'equazione~\ref{eq:r17xh} verifica le condizioni $h(0)=1$, $\diff{h}{m} <0$ e $\lim_{m \to \infty} h(m) = 0$.

In \cite{sumMar04} si suggerisce $h(m) \approx e^{-km}$ con $k\geq0$, e questa è la forma utilizzata in \cite{ratti2017} per le simulazioni numeriche.


\subsection{Analisi del modello con parametri costanti}
Seguiamo l'impostazione dello studio \cite{ratti2017} per l'analisi del modello, iniziando con l'esame di sotto-casi più semplici, estendendo progressivamente i risultati fino al modello completo.

\paragraph{}
Dapprima assumiamo l'ipotesi di lavoro di coefficienti costanti; utilizzeremo in seguito la teoria di Floquet per analizzare il caso di coefficienti periodici (sottosezione~\ref{sez:paramPeriodici}).

\paragraph{}
Per le dimostrazioni dei risultati esposti in questa sottosezione, si rimanda all'articolo originale \cite[11--15]{ratti2017}.

\subsubsection{Modello bidimensionale senza patogeni}
In assenza di \emph{Varroa} e di virus, il modello \eqref{eq:r17xh}--\eqref{eq:r17n} si riduce alle due sole equazioni per le api sane:
\begin{align}
    \diff{x_h}{t} &= \mu g( x_h + x_f ) - d_1 x_h - x_h \left( \sigma_1 - \sigma_2 \frac{x_f}{x_h + x_f} \right)
    \label{eq:rattiRidotto1prima}
    \\
    \diff{x_f}{t} &= x_h \left( \sigma_1 - \sigma_2 \frac{x_f}{x_h + x_f} \right) - (p + d_2) x_f
    \label{eq:rattiRidotto1seconda}
\end{align}
dove $g(x_h + x_f) = \frac{ (x_h+x_f)^i }{ K^i + (x_h+x_f)^i }$ come nella \eqref{eq:hillSigmoid}.

\paragraph{}
L'equilibrio banale $(x_h, x_f) = (0,0)$ esiste sempre, ed è asintoticamente stabile.

Nelle parole degli autori, ciò significa che
\begin{displayquote}[\cite{ratti2017}]
``\omissis in order to establish itself as a properly working colony, a sufficiently large healthy adult bee population is required to take care of the brood.''
\end{displayquote}

E viceversa, se il numero di operaie sane scende sotto un valore critico, la colonia si avvia verso una morte inesorabile.
Si noti che questo effetto di tipo Allee si osserva già nel modello senza patogeni; l'introduzione di \emph{Varroa} e virus non può che esacerbare tale fenomeno.

\paragraph{}
Se $\frac{\sigma_2 F}{1+F} - d_1 - \sigma_1 >0$ allora il modello ammette soltanto l'equilibrio banale.

Viceversa, se tale disequazione è invertita, possiamo formulare una condizione sufficiente per l'esistenza di due equilibri strettamente positivi.
Poniamo per comodità
$$
    F \coloneq \frac{1}{2} \left( \frac{ \sigma_1 - \sigma_2 - p - d_2 }{p+d_2} +
    \sqrt{ {\left( \frac{ \sigma_1 - \sigma_2 - p - d_2 }{p+d_2} \right)}^2 + \frac{4 \sigma_1}{p+d_2} } \, \right),
$$
ed osserviamo che la \eqref{eq:rattiRidotto1seconda} implica che ogni punto di equilibrio positivo $(x_h^*, x_f^*)$ verifica la relazione $x_f^* = F x_h^*$.

Definiamo inoltre la quantità
$$ a \coloneq - \frac{ \mu }{ \frac{\sigma_2 F}{1+F} - d_1 - \sigma_1 }, $$
che ci permette di stabilire il seguente criterio: se $\frac{\sigma_2 F}{1+F} - d_1 - \sigma_1 <0$ ed inoltre
$$a > \frac{Ki}{1+F} (i-1)^{- (1+ 1/i)},$$
allora esistono due equilibri non banali (positivi).

\paragraph{}
Se esistono, gli equilibri positivi sono stabili se
\begin{equation}
\frac{i \mu K^i {(x_h^*)}^{i-1} {(1+F)}^{i-1}}{ {\left( K^i + {(x_h^*)}^i {(1+F)}^i \right)}^2 }
<
\frac{d_1 + (p+d_2) F}{{(1+F)}^2}.
\label{eq:rattiRidotto1stability}
\end{equation}

\subsubsection{Modello tridimensionale api--acaro}
Introduciamo adesso nella colonia le varroe senza virus, ed indaghiamo la conseguente alterazione della stabilità degli equilibri individuati nel caso precedente.

Si eliminano quindi dal modello \eqref{eq:r17xh}--\eqref{eq:r17n} le equazioni per le api infette da ABPV e per le varroe che trasportano il virus; notiamo che da $m \equiv 0$ segue che $h(m) \equiv 1$.

\paragraph{}
Il modello ridotto che si ottiene è il seguente:

\begin{align}
    \diff{x_h}{t} &= \mu g( x_h + x_f ) - (d_1 + \delta_1) x_h - \gamma_1 n x_h
        - x_h \left( \sigma_1 - \sigma_2 \frac{x_f}{x_h + x_f} \right)
        \label{eq:rattiRidotto2prima}
    \\
    \diff{x_f}{t} &= x_h \left( \sigma_1 - \sigma_2 \frac{x_f}{x_h + x_f} \right) - (p + d_2 + \delta_2) x_f
        - \gamma_2 n x_f
        \label{eq:rattiRidotto2seconda}
    \\
    \diff{n}{t} &= rn \left( 1 - \frac{n}{ \alpha (x_h + x_f) } \right) - \delta_5 n
        \label{eq:rattiRidotto2terza}
\end{align}

Anche in questo caso, l'equilibrio banale $(x_h, x_f, n)=(0,0,0)$ esiste ed è sempre asintoticamente stabile, con la medesima interpretazione pratica del caso precedente (effetto Allee forte).

\paragraph{Equilibrio senza varroe. } Consideriamo adesso un equilibrio non banale $(x_h^*, x_f^*)$ per il modello \eqref{eq:rattiRidotto1prima}--\eqref{eq:rattiRidotto1seconda}, secondo le condizioni di esistenza date sopra.
Il punto $(x_h^*, x_f^*, 0)$ è un equilibrio per il modello \eqref{eq:rattiRidotto2prima}--\eqref{eq:rattiRidotto2terza}.

Se $r > \delta_5$ allora è instabile; se viceversa $r< \delta_5$ allora il punto $(x_h^*, x_f^*, 0)$ eredita la stabilità di $(x_h^*, x_f^*)$ sotto le \eqref{eq:rattiRidotto1prima}--\eqref{eq:rattiRidotto1seconda}.

\paragraph{}
Ciò significa che l'equilibrio senza varroe è stabile se la \eqref{eq:rattiRidotto1stability} è soddisfatta
ed il tasso massimo di natalità delle varroe è inferiore alla loro mortalità dovuta ai trattamenti.
Si osservi inoltre che in assenza di trattamenti varroacidi l'alveare non riesce a debellare l'infestazione dell'acaro.

Nel caso instabile, non è chiaro se il sistema converge all'equilibrio banale oppure ad un equilibrio endemico. \cite[15]{ratti2017}.


\subsubsection{Modello completo api--\emph{Varroa}--ABPV}
Consideriamo infine il modello completo \eqref{eq:r17xh}--\eqref{eq:r17n} e studiamo la stabilità dell'equilibrio senza patogeni.

Sia $(x_h^*, x_f^*)$ un equilibrio positivo per il modello ridotto \eqref{eq:rattiRidotto1prima}--\eqref{eq:rattiRidotto1seconda}, sempre secondo le condizioni di esistenza di cui sopra; che $(x_h^*, x_f^*, 0,0,0)$ sia un equilibrio per \eqref{eq:r17xh}--\eqref{eq:r17n} è ovvio.

Se valgono entrambe le disuguaglianze
$$
\begin{sistema}
    r - \beta_3 - \delta_4 < 0 \\
    r - \delta_5 < 0,
\end{sistema}
$$
allora $(x_h^*, x_f^*, 0,0,0)$ eredita la stabilità di $(x_h^*, x_f^*)$ sotto le \eqref{eq:rattiRidotto1prima}--\eqref{eq:rattiRidotto1seconda}.
Se invece (almeno) una delle disuguaglianze è invertita, l'equilibrio è instabile.

\paragraph{}
Quest'ultimo risultato si può interpetare con la seguente condizione: affinché l'alveare sconfigga completamente la \emph{Varroa} ed il virus, è necessario e sufficiente che
\begin{itemize}
    \item i trattamenti varroacidi siano abbastanza potenti da eradicare gli acari che non portano ABPV;
    \item le varroe portatrici perdano la loro carica virale ad un tasso più rapido della loro natalità.
\end{itemize}

L'esperienza sul campo dell'apicoltura, sia sperimentale che in produzione, indica come estremamente improbabile l'eradicazione completa della \emph{Varroa}.~\cite{privFPan}

Piuttosto, è più ragionevole che \textquote[\cite{privFDL}]{a livello di alveare o di apiario, si riesca a mantenere per un certo periodo (almeno 3 o 4 stagioni) un equilibrio in cui api e varroe coesistono senza causare il collasso delle colonie.}

Ciò corrisponderebbe alla presenza di un equilibrio endemico nel modello, la cui esistenza tuttavia non è ancora dimostrata.
Notiamo inoltre che abbiamo condizioni sufficienti per la stabilità degli equilibri positivi, ma non per la stabilità asintotica: un punto di equilibrio stabile ma non attrattivo potrebbe presentare dei cicli-limite.


\paragraph{}
Le attività in apiario che promuovono la sopravvivenza dell'alveare richiedono un monitoraggio costante e diversi tipi di interventi, che includono i trattamenti acaricidi, ma che non possono limitarsi al contrasto della \emph{Varroa}: è infatti necessario il mantenimento di \textquote[\cite{privFDL}]{\omissis uno stato di salute complessivamente buono nella colonia, che riguarda anche l'efficienza del sistema immunitario, la ``forza'' della famiglia in termini di operaie sane, le scorte di cibo, la salute della regina, e molti altri fattori.}

Questo elemento di complessità è catturato anche nel modello relativamente semplice di \cite{ratti2017}, in quanto le condizioni di esistenza e stabilità dei punti di equilibrio includono una molteplicità di parametri, che nel modello rappresentano non solo gli effetti ``diretti'' dovuti all'acaro e al virus, ma anche lo stato di salute dell'alveare, compresa la sua capacità di allevare covata e di approvvigionarsi di cibo.


\subsection{Analisi del modello con parametri periodici}
\label{sez:paramPeriodici}
Questo ultimo passaggio è fondamentale per incorporare nel modello le variazioni stagionali nel tasso di deposizione da parte della regina, l'arresto della raccolta di cibo nel periodo invernale e di molte altre attività dell'alveare.

Il periodo dei coefficienti è dunque $T= 1 \text{ anno}$.





\subsection{Riduzioni ai modelli precedenti}
Se nell'espressione di $g$ (equazione~\eqref{eq:hillSigmoid}) prendiamo $K=0$ ci riduciamo al modello di \cite{sumMar04}


